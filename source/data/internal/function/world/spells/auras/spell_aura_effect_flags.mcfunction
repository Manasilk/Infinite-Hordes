#Remove existing aura effect flags if effect has faded
tag @s[tag=SPELL_AURA_RidING_BOAT,nbt=!{RootVehicle:{Entity:{id:"minecraft:boat"}}}] remove SPELL_AURA_RidING_BOAT
tag @s[tag=SPELL_AURA_RidING_MOUNT,nbt=!{RootVehicle:{Entity:{}}}] remove SPELL_AURA_RidING_MOUNT
tag @s[tag=SPELL_AURA_SPEED,nbt=!{active_effects:[{id:"minecraft:speed"}]}] remove SPELL_AURA_SPEED
tag @s[tag=SPELL_AURA_SLOWNESS,nbt=!{active_effects:[{id:"minecraft:slowness"}]}] remove SPELL_AURA_SLOWNESS
tag @s[tag=SPELL_AURA_HASTE,nbt=!{active_effects:[{id:"minecraft:haste"}]}] remove SPELL_AURA_HASTE
tag @s[tag=SPELL_AURA_MINING_FATIGUE,nbt=!{active_effects:[{id:"minecraft:mining_fatigue"}]}] remove SPELL_AURA_MINING_FATIGUE
tag @s[tag=SPELL_AURA_STRENGTH,nbt=!{active_effects:[{id:"minecraft:strength"}]}] remove SPELL_AURA_STRENGTH
tag @s[tag=SPELL_AURA_INSTANT_HEALTH,nbt=!{active_effects:[{id:"minecraft:instant_health"}]}] remove SPELL_AURA_INSTANT_HEALTH
tag @s[tag=SPELL_AURA_INSTANT_DAMAGE,nbt=!{active_effects:[{id:"minecraft:instant_damage"}]}] remove SPELL_AURA_INSTANT_DAMAGE
tag @s[tag=SPELL_AURA_JUMP_BOOST,nbt=!{active_effects:[{id:"minecraft:jump_boost"}]}] remove SPELL_AURA_JUMP_BOOST
tag @s[tag=SPELL_AURA_NAUSEA,nbt=!{active_effects:[{id:"minecraft:nausea"}]}] remove SPELL_AURA_NAUSEA
tag @s[tag=SPELL_AURA_REGENERATION,nbt=!{active_effects:[{id:"minecraft:regeneration"}]}] remove SPELL_AURA_REGENERATION
tag @s[tag=SPELL_AURA_RESISTANCE,nbt=!{active_effects:[{id:"minecraft:resistance"}]}] remove SPELL_AURA_RESISTANCE
tag @s[tag=SPELL_AURA_FIRE_RESISTANCE,nbt=!{active_effects:[{id:"minecraft:fire_resistance"}]}] remove SPELL_AURA_FIRE_RESISTANCE
tag @s[tag=SPELL_AURA_WATER_BREATHING,nbt=!{active_effects:[{id:"minecraft:water_breathing"}]}] remove SPELL_AURA_WATER_BREATHING
tag @s[tag=SPELL_AURA_INVISIBILITY,nbt=!{active_effects:[{id:"minecraft:invisibility"}]}] remove SPELL_AURA_INVISIBILITY
tag @s[tag=SPELL_AURA_BLINDNESS,nbt=!{active_effects:[{id:"minecraft:blindness"}]}] remove SPELL_AURA_BLINDNESS
tag @s[tag=SPELL_AURA_NIGHT_VISION,nbt=!{active_effects:[{id:"minecraft:night_vision"}]}] remove SPELL_AURA_NIGHT_VISION
tag @s[tag=SPELL_AURA_HUNGER,nbt=!{active_effects:[{id:"minecraft:hunger"}]}] remove SPELL_AURA_HUNGER
tag @s[tag=SPELL_AURA_WEAKNESS,nbt=!{active_effects:[{id:"minecraft:weakness"}]}] remove SPELL_AURA_WEAKNESS
tag @s[tag=SPELL_AURA_POISON,nbt=!{active_effects:[{id:"minecraft:poison"}]}] remove SPELL_AURA_POISON
tag @s[tag=SPELL_AURA_WITHER,nbt=!{active_effects:[{id:"minecraft:wither"}]}] remove SPELL_AURA_WITHER
tag @s[tag=SPELL_AURA_HEALTH_BOOST,nbt=!{active_effects:[{id:"minecraft:health_boost"}]}] remove SPELL_AURA_HEALTH_BOOST
tag @s[tag=SPELL_AURA_ABSORPTION,nbt=!{active_effects:[{id:"minecraft:absorption"}]}] remove SPELL_AURA_ABSORPTION
tag @s[tag=SPELL_AURA_SATURATION,nbt=!{active_effects:[{id:"minecraft:saturation"}]}] remove SPELL_AURA_SATURATION
tag @s[tag=SPELL_AURA_GLOWING,nbt=!{active_effects:[{id:"minecraft:glowing"}]}] remove SPELL_AURA_GLOWING
tag @s[tag=SPELL_AURA_LEVITATION,nbt=!{active_effects:[{id:"minecraft:levitation"}]}] remove SPELL_AURA_LEVITATION
tag @s[tag=SPELL_AURA_LUCK,nbt=!{active_effects:[{id:"minecraft:luck"}]}] remove SPELL_AURA_LUCK
tag @s[tag=SPELL_AURA_BAD_LUCK,nbt=!{active_effects:[{id:"minecraft:bad_luck"}]}] remove SPELL_AURA_BAD_LUCK
tag @s[tag=SPELL_AURA_SLOW_FALLING,nbt=!{active_effects:[{id:"minecraft:slow_falling"}]}] remove SPELL_AURA_SLOW_FALLING
tag @s[tag=SPELL_AURA_CONDUIT_POWER,nbt=!{active_effects:[{id:"minecraft:conduit_power"}]}] remove SPELL_AURA_CONDUIT_POWER
tag @s[tag=SPELL_AURA_DOLPHINS_GRACE,nbt=!{active_effects:[{id:"minecraft:dolphins_grace"}]}] remove SPELL_AURA_DOLPHINS_GRACE
tag @s[tag=SPELL_AURA_BAD_OMEN,nbt=!{active_effects:[{id:"minecraft:bad_omen"}]}] remove SPELL_AURA_BAD_OMEN
tag @s[tag=SPELL_AURA_HERO_OF_THE_VILLAGE,nbt=!{active_effects:[{id:"minecraft:hero_of_the_village"}]}] remove SPELL_AURA_HERO_OF_THE_VILLAGE
execute if block ~ ~1 ~ #internal:collision/vmap run tag @s[tag=SPELL_AURA_UNDERWATER] remove SPELL_AURA_UNDERWATER
#Apply aura effect flags if not yet added and effect exists
tag @s[tag=!SPELL_AURA_RidING_MOUNT,tag=!SPELL_AURA_RidING_BOAT,nbt={RootVehicle:{Entity:{id:"minecraft:boat"}}}] add SPELL_AURA_RidING_BOAT
tag @s[tag=!SPELL_AURA_RidING_MOUNT,tag=!SPELL_AURA_RidING_BOAT,nbt={RootVehicle:{Entity:{}}}] add SPELL_AURA_RidING_MOUNT
execute if block ~ ~1 ~ #internal:fluids run tag @s[tag=!SPELL_AURA_UNDERWATER] add SPELL_AURA_UNDERWATER
tag @s[tag=!SPELL_AURA_SPEED,nbt={active_effects:[{id:"minecraft:speed"}]}] add SPELL_AURA_SPEED
tag @s[tag=!SPELL_AURA_SLOWNESS,nbt={active_effects:[{id:"minecraft:slowness"}]}] add SPELL_AURA_SLOWNESS
tag @s[tag=!SPELL_AURA_HASTE,nbt={active_effects:[{id:"minecraft:haste"}]}] add SPELL_AURA_HASTE
tag @s[tag=!SPELL_AURA_MINING_FATIGUE,nbt={active_effects:[{id:"minecraft:mining_fatigue"}]}] add SPELL_AURA_MINING_FATIGUE
tag @s[tag=!SPELL_AURA_STRENGTH,nbt={active_effects:[{id:"minecraft:strength"}]}] add SPELL_AURA_STRENGTH
tag @s[tag=!SPELL_AURA_INSTANT_HEALTH,nbt={active_effects:[{id:"minecraft:instant_health"}]}] add SPELL_AURA_INSTANT_HEALTH
tag @s[tag=!SPELL_AURA_INSTANT_DAMAGE,nbt={active_effects:[{id:"minecraft:instant_damage"}]}] add SPELL_AURA_INSTANT_DAMAGE
tag @s[tag=!SPELL_AURA_JUMP_BOOST,nbt={active_effects:[{id:"minecraft:jump_boost"}]}] add SPELL_AURA_JUMP_BOOST
tag @s[tag=!SPELL_AURA_NAUSEA,nbt={active_effects:[{id:"minecraft:nausea"}]}] add SPELL_AURA_NAUSEA
tag @s[tag=!SPELL_AURA_REGENERATION,nbt={active_effects:[{id:"minecraft:regeneration"}]}] add SPELL_AURA_REGENERATION
tag @s[tag=!SPELL_AURA_RESISTANCE,nbt={active_effects:[{id:"minecraft:resistance"}]}] add SPELL_AURA_RESISTANCE
tag @s[tag=!SPELL_AURA_FIRE_RESISTANCE,nbt={active_effects:[{id:"minecarft:fire_resistance"}]}] add SPELL_AURA_FIRE_RESISTANCE
tag @s[tag=!SPELL_AURA_WATER_BREATHING,nbt={active_effects:[{id:"minecraft:water_breathing"}]}] add SPELL_AURA_WATER_BREATHING
tag @s[tag=!SPELL_AURA_INVISIBILITY,nbt={active_effects:[{id:"minecraft:invisibility"}]}] add SPELL_AURA_INVISIBILITY
tag @s[tag=!SPELL_AURA_BLINDNESS,nbt={active_effects:[{id:"minecraft:blindness"}]}] add SPELL_AURA_BLINDNESS
tag @s[tag=!SPELL_AURA_NIGHT_VISION,nbt={active_effects:[{id:"minecraft:night_vision"}]}] add SPELL_AURA_NIGHT_VISION
tag @s[tag=!SPELL_AURA_HUNGER,nbt={active_effects:[{id:"minecraft:hunger"}]}] add SPELL_AURA_HUNGER
tag @s[tag=!SPELL_AURA_WEAKNESS,nbt={active_effects:[{id:"minecraft:weakness"}]}] add SPELL_AURA_WEAKNESS
tag @s[tag=!SPELL_AURA_POISON,nbt={active_effects:[{id:"minecraft:poison"}]}] add SPELL_AURA_POISON
tag @s[tag=!SPELL_AURA_WITHER,nbt={active_effects:[{id:"minecraft:wither"}]}] add SPELL_AURA_WITHER
tag @s[tag=!SPELL_AURA_HEALTH_BOOST,nbt={active_effects:[{id:"minecraft:health_boost"}]}] add SPELL_AURA_HEALTH_BOOST
tag @s[tag=!SPELL_AURA_ABSORPTION,nbt={active_effects:[{id:"minecraft:absorption"}]}] add SPELL_AURA_ABSORPTION
tag @s[tag=!SPELL_AURA_SATURATION,nbt={active_effects:[{id:"minecraft:saturation"}]}] add SPELL_AURA_SATURATION
tag @s[tag=!SPELL_AURA_GLOWING,nbt={active_effects:[{id:"minecraft:glowing"}]}] add SPELL_AURA_GLOWING
tag @s[tag=!SPELL_AURA_LEVITATION,nbt={active_effects:[{id:"minecraft:levitation"}]}] add SPELL_AURA_LEVITATION
tag @s[tag=!SPELL_AURA_LUCK,nbt={active_effects:[{id:"minecraft:luck"}]}] add SPELL_AURA_LUCK
tag @s[tag=!SPELL_AURA_BAD_LUCK,nbt={active_effects:[{id:"minecraft:bad_luck"}]}] add SPELL_AURA_BAD_LUCK
tag @s[tag=!SPELL_AURA_SLOW_FALLING,nbt={active_effects:[{id:"minecraft:slow_falling"}]}] add SPELL_AURA_SLOW_FALLING
tag @s[tag=!SPELL_AURA_CONDUIT_POWER,nbt={active_effects:[{id:"minecraft:conduit_power"}]}] add SPELL_AURA_CONDUIT_POWER
tag @s[tag=!SPELL_AURA_DOLPHINS_GRACE,nbt={active_effects:[{id:"minecraft:golphins_grace"}]}] add SPELL_AURA_DOLPHINS_GRACE
tag @s[tag=!SPELL_AURA_BAD_OMEN,nbt={active_effects:[{id:"minecraft:bad_omen"}]}] add SPELL_AURA_BAD_OMEN
tag @s[tag=!SPELL_AURA_HERO_OF_THE_VILLAGE,nbt={active_effects:[{id:"minecraft:hero_of_the_village"}]}] add SPELL_AURA_HERO_OF_THE_VILLAGE